

EchoWithColor(COLOR GREEN "-- Configure libcopp")


# ========== build library ==========
source_group_by_dir(COPP_SRC_LIST)
# source_group_by_dir(COPP_OBJ_LIST)

if (LIBCOPP_FCONTEXT_USE_TSX)
    add_compiler_define(LIBCOPP_FCONTEXT_USE_TSX=1)
endif()

add_library(${PROJECT_LIBCOPP_LIB_LINK} ${COPP_SRC_LIST} ${COPP_OBJ_LIST})

install(TARGETS ${PROJECT_LIBCOPP_LIB_LINK}
    RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR}
    LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}
    ARCHIVE DESTINATION ${CMAKE_INSTALL_LIBDIR}
)

install(DIRECTORY "${PROJECT_LIBCOPP_INC_DIR}"
    DESTINATION ${CMAKE_INSTALL_INCLUDEDIR}
    USE_SOURCE_PERMISSIONS
    PATTERN ".svn" EXCLUDE
    PATTERN ".git" EXCLUDE
    PATTERN "*.in" EXCLUDE
)
