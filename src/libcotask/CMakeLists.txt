

EchoWithColor(COLOR GREEN "-- Configure libcotask")

# ========== filter sources files ==========
file(GLOB_RECURSE COTASK_SRC_LIST
    RELATIVE "${PROJECT_LIBCOTASK_SRC_DIR}" 
    ${PROJECT_LIBCOTASK_INC_DIR}/*.h 
    ${PROJECT_LIBCOTASK_INC_DIR}/*.hpp
)

file(GLOB_RECURSE SRC_LIST ${PROJECT_LIBCOTASK_SRC_DIR}/*.c ${PROJECT_LIBCOTASK_SRC_DIR}/*.cpp)
list(LENGTH SRC_LIST SRC_LIST_LENGTH)
if( ${SRC_LIST_LENGTH} GREATER 0 )
	list(APPEND COTASK_SRC_LIST ${SRC_LIST})
endif()

# ========== build library ==========
source_group_by_dir(COTASK_SRC_LIST)

add_library(${PROJECT_LIBCOTASK_LIB_LINK} ${COTASK_SRC_LIST})

install(TARGETS ${PROJECT_LIBCOTASK_LIB_LINK}
    RUNTIME DESTINATION bin
    LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}
    ARCHIVE DESTINATION ${CMAKE_INSTALL_LIBDIR}
)

install(DIRECTORY "${PROJECT_LIBCOTASK_INC_DIR}"
    DESTINATION include
    USE_SOURCE_PERMISSIONS
    PATTERN ".svn" EXCLUDE
    PATTERN ".git" EXCLUDE
)
